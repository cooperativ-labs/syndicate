

"""
DOCUMENT MODEL
"""
enum DocumentFormat {
	GOOGLE_DRIVE
	GOOGLE_DOC
	GOOGLE_SHEET
	GOOGLE_SLIDE
	WORD_DOC
	EXCEL
	POWERPOINT
	PDF
	NOTION
	GITHUB
	MARKDOWN
	VIDEO
	OTHER
}

enum DocumentType {
	GENERAL
	SHARE_LINK
	PPM
	OPERATING_AGREEMENT
	DISCLOSURE
	REG_FILING
	FINANCIAL_STATEMENT
	AGREEMENT
	OTHER
	OFFERING_DOCUMENT
}

enum DocumentAccessType {
	OWNER
	SIGNATORY
	TOKEN
	PUBLIC
}

type DocumentSignatory @auth (
	update:	{rule: """
						query($userId: ID!) { 
								queryDocumentSignatory{
									document{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}										
										}
										}
									}
						}"""

	}
	delete:	{rule: """
						query($userId: ID!) { 
								queryDocumentSignatory{
									document{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}										
										}
										}
									}
						}"""
	}
) 
 {
	id: ID!
	document: Document! @hasInverse(field:signatories) 
	legalEntity: LegalEntity @hasInverse(field:documentsSigned) 
	signerAddress: String
	signature: String 
	date: DateTime
	archived: Boolean
}

type Document @auth (
# add:	{rule: """
# 						query($userId: ID!) { 
# 								queryDocument{
# 									owner{
	# 										organization{
# 													users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
# 													user(filter: { id: [$userId] }) { id }
# 												}
# 										}}
# 									}
# 						}"""

# 	}
	update:	{rule: """
						query($userId: ID!) { 
								queryDocument{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}}
									}
						}"""

	}
	delete:	{rule: """
						query($userId: ID!) { 
								queryDocument{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}}
									}
						}"""
	}
) {
	id: ID!
	title: String 
	text: String
	date: DateTime
	format: DocumentFormat 
	type: DocumentType
	url: String
	fileId: String @search
	thumbnailImage: Image
	owner: LegalEntity @hasInverse(field:documentsOwned)
	signatories: [DocumentSignatory] @hasInverse(field:document) 
	smartContract: SmartContract @hasInverse(field:document) 
	creationDate: DateTime!
	lastUpdate: DateTime! 
	access: DocumentAccessType
	offering: Offering @hasInverse(field:documents)
	offeringUniqueId: String! @id
}

type Image {
	id: ID!
	label: String
	url: String!
	fileId: String
}


"""
CRYPTO MODEL 
"""

enum CryptoAddressProtocol {
	ETH
	BTC
	ADA
	ALGO
}

enum CryptoAddressType {
	WALLET
	CONTRACT
}

type CryptoAddress @auth (
add:{rule: """
						query($userId: ID!) { 
								queryCryptoAddress{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}}
										}
									}
						}"""
	}
	update:{rule: """
						query($userId: ID!) { 
								queryCryptoAddress{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}}
										}
									}
						}"""
	
	}
	delete:{rule: """
						query($userId: ID!) { 
								queryCryptoAddress{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}}
										}
									}
						}"""
	}

) {
	id: ID!
	name: String 
	address: String! @id
	description: String
	protocol: CryptoAddressProtocol 
	chainId: Int
	type: CryptoAddressType 
	isPublic: Boolean @search
	owner: LegalEntity @hasInverse(field:walletAddresses) 
}


enum SmartContractType {
	C2
	C3
	EXCHANGE_MANAGER
	SHARE
	SWAP
	DISTRIBUTION
	OTHER
}

type SmartContract @auth (
add: {rule: """
						query($userId: ID!) { 
								querySmartContract{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
															user(filter: { id: [$userId] }) { id }
												}}
										}
									}
						}"""

	}
	update: {rule: """
						query($userId: ID!) { 
								querySmartContract{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
															user(filter: { id: [$userId] }) { id }
												}}
										}
									}
						}"""
	
	}
	delete: {rule: """
						query($userId: ID!) { 
								querySmartContract{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
															user(filter: { id: [$userId] }) { id }
												}}
										}
									}
						}"""
	
	}
)  {
	id: ID!
	cryptoAddress: CryptoAddress!
	type: SmartContractType!
	subType: String
	numTokensAuthorized: Int64
	backingToken: Currency
	owner: LegalEntity @hasInverse(field:smartContracts)
	offering: Offering @hasInverse(field:smartContracts)
	name: String
	document: Document
	established: Boolean
	partitions: [String]
}


"""
OFFERING MODEL
"""
enum OfferingTabSection {
	DETAILS
	FINANCIALS
	TERMS
	OFFEROR_INFO
	DISCLOSURES
}

type OfferingDescriptionText @auth (
add:,
			{rule: """
						query($userId: ID!) { 
								queryOfferingDescriptionText{
									offering{
									offeringEntity{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}}
										}}
									}
						}"""
	}
	update:,
			{rule: """
						query($userId: ID!) { 
								queryOfferingDescriptionText{
									offering{
									offeringEntity{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}}
										}}
									}
						}"""
	}
	delete:,
			{rule: """
						query($userId: ID!) { 
								queryOfferingDescriptionText{
									offering{
									offeringEntity{
										organization{
											users(filter: { permissions: { eq: ADMIN } }) {
													user(filter: { id: [$userId] }) { id }
												}}
										}}
									}
						}"""
	}
){ 
	id: ID!
	section: OfferingTabSection!
	title: String!
	text: String!
	order: Int!
	offering:	Offering @hasInverse(field: profileDescriptions)
	creationDate: DateTime! 
	lastUpdate: DateTime! 
}

type Offering @auth (
add:
			{rule: """
						query($userId: ID!) { 
								queryOffering{
									offeringEntity{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}}
									}
						}"""
	}
	update:
			{rule: """
						query($userId: ID!) { 
								queryOffering{
									offeringEntity{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}}
									}
						}"""
	}
	delete:
			{rule: """
						query($userId: ID!) { 
								queryOffering{
									offeringEntity{
										organization{
											users(filter: { permissions: { eq: ADMIN }}) {
													user(filter: { id: [$userId] }) { id }
												}
										}}
									}
						}"""
	}
) {
	id: ID! 
	creationDate: DateTime! 
	lastUpdate: DateTime! 
	name: String! @search(by:[fulltext]) 
	image: String 
	bannerImage: String
	primaryVideo:	String
	sharingImage: Image
	brandColor: String 
	lightBrand: Boolean
	website: String 
	shortDescription: String
	offeringEntity: LegalEntity @hasInverse(field:offerings) 
	smartContracts: [SmartContract] @hasInverse(field:offering)
	details: OfferingDetails @hasInverse(field:offering)
	profileDescriptions: [OfferingDescriptionText] @hasInverse(field:offering)
	purchaseRequests: [PurchaseRequest] @hasInverse(field:relatedOffering)
	sales: [OfferingSale] @hasInverse(field:relatedOffering)
	participants: [OfferingParticipant] @hasInverse(field:offering)
	distributions: [OfferingDistribution]
	documents: [Document] @hasInverse(field:offering)
	isPublic: Boolean
	waitlistOn: Boolean
	waitlistMembers: [WaitlistMember] @hasInverse(field:offering)
	accessCode: String
}

enum OfferingDetailsType {
	CRYPTO
	PRIVATE_EQUITY
	REAL_ESTATE
	VENTURE_CAPITAL
	OTHER
}

enum DistributionPeriodType {
	DAY
	WEEK
	MONTH
	QUARTER
	YEAR
	UNSPECIFIED
	DESCRIBED
	NONE
}

enum OfferingStage {
	IDENTIFIED
	IN_NEGOTIATION
	DUE_DILIGENCE
	SALE
	LOCKED
	CLOSED
}

type OfferingDetails @auth (
add:{rule: """
						query($userId: ID!) { 
								queryOfferingDetails{
									offering{
										offeringEntity{
											organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
													}
												}}
											}
									}
							}"""
					}

					update:{rule: """
						query($userId: ID!) { 
								queryOfferingDetails{
									offering{
										offeringEntity{
											organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
													}
												}}
											}
									}
							}"""
					}
					
					delete:{rule: """
						query($userId: ID!) { 
								queryOfferingDetails{
									offering{
										offeringEntity{
											organization{
											users(filter: {permissions: { eq: ADMIN } }) {
													user(filter: { id: [$userId] }) { id }
													}
												}}
											}
									}
							}"""
					}
){
	id: ID!
	offering: Offering! @hasInverse(field:details)
	customOnboardingLink: String
	type: OfferingDetailsType
	stage: OfferingStage
	investmentCurrency: Currency!
	maxRaise: Int64
	minRaise: Int64
	numUnits: Int
	minUnitsPerInvestor: Int
	maxUnitsPerInvestor: Int
	priceStart: Int
	maxInvestors: Int
	minInvestors: Int
	raiseStart: DateTime
	raisePeriod: Int
	additionalInfo: String
	distributionPeriod: DistributionPeriodType
	distributionFrequency: Int
	distributionCurrency: Currency
	distributionDescription: String
	adminExpense: Int
 projectedIrr: Int
	projectedIrrMax: Int
	preferredReturn: Int
	targetEquityMultiple: Int
	targetEquityMultipleMax: Int
 cocReturn: Int
 projectedAppreciation: Int
 capRate: Int
}

# TEMPORARY
type WaitlistMember {
	id: ID!
	name: String
	offering: Offering! @hasInverse(field:waitlistMembers)
	walletAddress: String
	minPledge: Int 
	maxPledge: Int
	investorApplication: InvestorApplication
	nonUS: Boolean
	lastUpdate: DateTime!
}

type OfferingParticipant @auth (
					# update:{rule: """
					# 	query($userId: ID!) { 
					# 			queryOfferingParticipant{
					# 				offering{
					# 					offeringEntity{
						#      organization{
				# 								users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
					# 								user(filter: { id: [$userId] }) { id }
					# 								}
					# 							}}
					# 						}
					# 				}
					# 		}"""
					# }
					
					delete:{rule: """
						query($userId: ID!) { 
								queryOfferingParticipant{
									offering{
										offeringEntity{
											organization{
											users(filter: {permissions: { eq: ADMIN } }) {
													user(filter: { id: [$userId] }) { id }
													}
												}}
											}
									}
							}"""
					}
) {
	id: ID!
	addressOfferingId: String! @id
	walletAddress: String! @search(by:[fulltext]) 
	chainId: Int!
	permitted: Boolean!
	name: String
	offering: Offering! @hasInverse(field:participants)
	investorApplication: InvestorApplication
	minPledge: Int
	maxPledge: Int
	jurisdiction: Jurisdiction
	paid: Boolean
	externalId: String
	lastUpdate: DateTime!
}

type InvestorApplication {
	id: ID!
	applicationDoc: Document!
	creationDate: DateTime!
}

type PurchaseRequest {
	id: ID!
	numUnits: Int!
	relatedOffering: Offering! @hasInverse(field:purchaseRequests) 
	purchaser: LegalEntity!
	purchaseDocument: Document!
	purchaserWallet: String!
	creationDate: DateTime!
}

type OfferingSale {
	id: ID!
	numShares: Int!
	minUnits: Int
	maxUnits: Int
	price: Int!
	relatedOffering: Offering! @hasInverse(field:sales) 
	saleContractAddress: String!
	orderId: Int!
	isAsk: Boolean
	initiator: String
	creationDate: DateTime!
	lastUpdate: DateTime
	visible: Boolean
}

type OfferingDistribution {
	id: ID!
	date: DateTime!
	amount: Int!
	transactionId: String
	hasClaimed: [String]
}

"""
REAL ESTATE PROPERTY MODEL
"""

enum AssetStatus {
	IDENTIFIED
	IN_NEGOTIATION
	DUE_DILIGENCE
	UNDER_CONTRACT
	CLOSED
	FOR_SALE
}

enum RealEstatePropertyType {
	SINGLE_FAMILY
	MULTI_FAMILY
	COMMERCIAL
	LAND_ONLY
	SELF_STORAGE
}

type RealEstateProperty @auth (
add:{ rule: """
						query($userId: ID!){ 
								queryRealEstateProperty{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}}
										}
									}
						}"""
			}
			update:{ rule: """
						query($userId: ID!){ 
								queryRealEstateProperty{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}}
										}
									}
						}"""
			}
			delete:{ rule: """
						query($userId: ID!){ 
								queryRealEstateProperty{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}}
										}
									}
						}"""
			}
)
 {
	id: ID!
	propertyType: RealEstatePropertyType!
	investmentStatus: AssetStatus
	address: Address
	amenitiesDescription: String
	images: [Image]
	description: String
	loan: Int
	downPayment: Int
	assetValue: Int
	assetValueNote: String
	lenderFees: Int
	closingCosts: Int
	creationDate: DateTime!
	lastUpdate: DateTime!
	owner: LegalEntity @hasInverse(field: realEstateProperties)
}

"""
ENTITY MODEL
"""


type Address @auth (
add:{rule: """
						query($userId: ID!){ 
								queryAddress{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}}
									}
						}"""
			}
			update:{rule: """
						query($userId: ID!){ 
								queryAddress{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}}
									}
						}"""
			}
			delete:{rule: """
						query($userId: ID!){ 
								queryAddress{
									owner{
										organization{
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}}
									}
						}"""
			}

) {
	id: ID!
	label: String
	line1: String
	line2: String
	line3: String
	city: String!
	stateProvince: String
	postalCode: String
	country: String!
	lat: Float
	lng: Float
	owner: LegalEntity @hasInverse(field: addresses)
}

type EmailAddress @auth (
add:{rule: """
						query($userId: ID!){ 
								queryEmailAddress{
									organization{
													users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}
									}
						}"""
			}
			update:{rule: """
						query($userId: ID!){ 
								queryEmailAddress{
									organization{
													users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}
									}
						}"""
			}
			delete:{rule: """
						query($userId: ID!){ 
								queryEmailAddress{
									organization{
													users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}
									}
						}"""
			}

)
{
	id: ID!
	address: String! @id
	name: String
	description: String
	isPublic: Boolean @search
	organization: Organization @hasInverse(field:emailAddresses)
}


enum LinkedAccountType  {
	LINKEDIN
	FACEBOOK
	TWITTER
	INSTAGRAM
	DISCORD
	TELEGRAM
	MEDIUM
	MIRROR
	SUBSTACK
	YOUTUBE
	SOUNDCLOUD
	DRIBBBLE
	GITHUB
	EMAIL
	PHONE
	WEBSITE
	OTHER
}


type LinkedAccount @auth (
add:{rule: """
						query($userId: ID!){ 
								queryLinkedAccount{
									organization{
													users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}
									}
						}"""
			}
			update:{rule: """
						query($userId: ID!){ 
								queryLinkedAccount{
									organization{
													users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}
									}
						}"""
			}
			delete:{rule: """
						query($userId: ID!){ 
								queryLinkedAccount{
									organization{
													users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
													user(filter: { id: [$userId] }) { id }
												}
										}
									}
						}"""
			}

){
	id: ID!
	accountProvidedId: String
	username: String @search(by:[term]) 
	url: String!
	type: LinkedAccountType 
	verified: Boolean
	hidden: Boolean
	organization: Organization! @hasInverse(field:linkedAccounts) 
}

type Jurisdiction {
	id: ID!
	country:	String!
	province: String
}


enum LegalEntityType {
	INDIVIDUAL
	CORPORATION
	LLC
	UNINCORPORATED_ASSOCIATION
}

type LegalEntity @auth (
	add: { rule: """
				query($userId: ID!) { 
							queryLegalEntity {

								organization {
									users {
									user(filter: { id: [$userId] }) { id }
							}
					}
					}
			}"""
		}
update:{rule: """
						query($userId: ID!)  { 
							queryLegalEntity {
										organization {
											users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {
																user(filter: { id: [$userId] }) { id }
											}
									}
									}
						}"""
			}
	delete:{rule: """
						query($userId: ID!)  { 
							queryLegalEntity {
										organization {
											users(filter: { permissions: { eq: ADMIN }}) {
																user(filter: { id: [$userId] }) { id }
											}
									}
									}
						}"""
			}
) {
	id: ID! 
	organization: Organization! @hasInverse(field: legalEntities)
	displayName: String @search(by:[fulltext]) 
	legalName: String @search(by:[fulltext]) 
	type: LegalEntityType! 
	taxId: String
	walletAddresses: [CryptoAddress] @hasInverse(field:owner) 
	owners: [LegalEntity] @hasInverse(field:subsidiaries) 
	subsidiaries: [LegalEntity] @hasInverse(field:owners) 
	purpose: String
	addresses: [Address] @hasInverse(field:owner)
	jurisdiction: Jurisdiction 
	documentsOwned: [Document] @hasInverse(field:owner) 
	documentsSigned: [DocumentSignatory] @hasInverse(field:legalEntity) 
	smartContracts: [SmartContract] @hasInverse(field:owner)
	operatingCurrency: Currency
	offerings: [Offering] @hasInverse(field:offeringEntity) 
 realEstateProperties: [RealEstateProperty] @hasInverse(field:owner)
	creationDate: DateTime!
	lastUpdate: DateTime!
}



### ORGANIZATION MODEL ###

enum OrganizationUserRole {
	BOARD_MEMBER
	PARTNER
	TEAM
	INVESTOR
	ADVISOR
	SUPPORTER
}


enum OrganizationPermissionType {
	ADMIN
	EDITOR
	VIEWER
	AUDITOR
}

type OrganizationUser 
@auth(
  add: { rule: """
    query($userId: ID!) {
      queryOrganizationUser {
       	organization {
											users(filter:  {permissions: { eq: ADMIN } }) {
																user(filter: { id: [$userId] }) { id }
											}
									}
      }
    }
    """
		},
		update: { rule: """
    query($userId: ID!) {
      queryOrganizationUser {
       	organization {
											users(filter:  {permissions: { eq: ADMIN } }) {
																user(filter: { id: [$userId] }) { id }
											}
									}
      }
    }
    """
		},
		 delete: { rule: """
    query($userId: ID!) {
      queryOrganizationUser {
       	organization {
											users(filter:  {permissions: { eq: ADMIN } }) {
																user(filter: { id: [$userId] }) { id }
											}
									}
      }
    }
    """
		}
){
	id: ID!
	organization: Organization! @hasInverse(field:users) 
	user: User! @hasInverse(field:organizations) 
	permissions: [OrganizationPermissionType!] @search
	# role: [OrganizationUserRole] @search
	# title: String
}

type Organization	
@auth (
	add: { rule: """
				query($userId: ID!) { 
							queryOrganization {
								users {
									user(filter: { id: [$userId] }) { id }
							}
					}
			}"""
		}
update:{rule: """
						query($userId: ID!)  { 
							queryOrganization {
												users(filter: { permissions: { in: [EDITOR, ADMIN] } }) {

																user(filter: { id: [$userId] }) { id }
											}
									}
						}"""
			}	
	delete:{rule: """
						query($userId: ID!)  { 
							queryOrganization {
										users(filter: { permissions: { eq: ADMIN }}) {
																user(filter: { id: [$userId] }) { id }
											}
									}
						}"""
			}
) 
{
 id: ID!
	name: String @search(by:[fulltext])
	logo: String 
	slug: String @search(by:[term])
	bannerImage: String
	sharingImage: Image
	brandColor: String 
	shortDescription: String
	description: String
	isPublic: Boolean @search
	phone: String
	country: String 
	emailAddresses: [EmailAddress] @hasInverse(field:organization)
	linkedAccounts: [LinkedAccount] @hasInverse(field:organization) 
	website: String 
	users: [OrganizationUser] @hasInverse(field:organization)
	legalEntities: [LegalEntity] @hasInverse(field:organization)
	creationDate: DateTime!
	lastUpdate: DateTime!
}

type User
  @auth(
    # query: {
    #   or: [
    #     {
    #       rule: """
    #       query ($userId: [ID!]) {queryUser(filter: { id:  $userId } ) {id}}
    #       """
    #     }
				# 					{ rule: "{$nextAuth: { eq: true } }" }
    #   ]
    # }
    delete: { rule: "{$nextAuth: { eq: true } }" }
    add: { rule: "{$nextAuth: { eq: true } }" }
    update: {
      or: [
        {
          rule: """
          query ($userId: [ID!]) {queryUser(filter: { id:  $userId } ) {id}}
          """
        }
   			 { rule: "{$admin: { eq: true } }" }
      ]
    }
  ) 
  {
  id: ID
  name: String
  email: String @search(by: [hash])
  emailVerified: DateTime
  image: String
  accounts: [Account] @hasInverse(field: "user")
  sessions: [Session] @hasInverse(field: "user")
		organizations: [OrganizationUser] @hasInverse(field:user) 
		creationDate: DateTime
}

type Account
  @auth(
    delete: { rule: "{$nextAuth: { eq: true } }" }
    add: { rule: "{$nextAuth: { eq: true } }" }
    query: { rule: "{$nextAuth: { eq: true } }" }
    update: { rule: "{$nextAuth: { eq: true } }" }
  ) 
  {
  id: ID
  type: String
  provider: String @search(by: [hash])
  providerAccountId: String @search(by: [hash])
  # refreshToken: String // removed to avoid type conflict with refresh_token
  expires_at: Int64
  # accessToken: String // removed to avoid type conflict with access_token
  token_type: String
  refresh_token: String
		refresh_token_expires_in: Int64
		not_before:	Int64
		id_token_expires_in: Int64
		profile_info:	String
  access_token: String
  scope: String
  id_token: String
  session_state: String
  user: User @hasInverse(field: "accounts")
}
type Session
  @auth(
    delete: { rule: "{$nextAuth: { eq: true } }" }
    add: { rule: "{$nextAuth: { eq: true } }" }
    query: { rule: "{$nextAuth: { eq: true } }" }
    update: { rule: "{$nextAuth: { eq: true } }" }
  ) 
  {
  id: ID
  expires: DateTime
  sessionToken: String @search(by: [hash])
  user: User @hasInverse(field: "sessions")
}

type VerificationToken
  @auth(
    delete: { rule: "{$nextAuth: { eq: true } }" }
    add: { rule: "{$nextAuth: { eq: true } }" }
    query: { rule: "{$nextAuth: { eq: true } }" }
    update: { rule: "{$nextAuth: { eq: true } }" }
  ) 
  {
  id: ID
  identifier: String @search(by: [hash])
  token: String @search(by: [hash])
  expires: DateTime
}

"""
CURRENCY
"""


type Currency  {
	code: CurrencyCode! 
}


enum CurrencyCode {
	CC
	USD
	KYD
	AUD
	CAD
	EUR
	GBP
	BTC
	ETH
	ADA
	MATIC
	USDC
	ALGO_USDC 
	PoS_USDC
	DAI
	PoS_DAI
	USDC_TEST_
	DAI_TEST_
 ALGO_USDC_TEST_ 
	USDC_MATIC_TEST_
	DAI_MATIC_TEST_
	REAL_SHARE
}


# Dgraph.Authorization {"VerificationKey":"b916c164e025f6901a3be022d8de4276aca4c0613290a1befc5109a98231748a","Header":"X-Auth-Token","Namespace":"https://cooperativ.io/jwt/claims","Algo":"HS256"}